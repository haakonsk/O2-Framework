package O2::Dispatch::ModPerlGlobals::Db;

use strict;

use Tie::Scalar;
our @ISA = qw(Tie::StdScalar);

#------------------------------------------------------------------------------------------------------------
sub TIESCALAR {
  my ($className) = @_;
  return bless {}, $className;
}
#------------------------------------------------------------------------------------------------------------
sub FETCH {
  my ($obj) = @_;
  my $db = $obj->{ $ENV{O2REQUESTID} };
  if (!$db) {
    $db = $O2::context->getDbh();
    $obj->STORE($db);
  }
  return $db;
}
#------------------------------------------------------------------------------------------------------------
sub STORE {
  my ($obj, $db) = @_;
  $obj->{ $ENV{O2REQUESTID} } = $db;
}
#------------------------------------------------------------------------------------------------------------
sub DESTROY {
  my ($obj) = @_;
}
#------------------------------------------------------------------------------------------------------------
1;
